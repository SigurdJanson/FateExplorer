@using FateExplorer.RollLogic

@inject IStringLocalizer<App> l10n


<MudCard Elevation=2 Class="pa-1 ma-1">
    <MudCardHeader>
        <CardHeaderAvatar>
            <MudAvatar  Color=Color.Secondary Square=true>
                <MudIcon Color=Color.Dark Icon=@GetAvatarIcon() />
            </MudAvatar>
        </CardHeaderAvatar>
        <CardHeaderContent>
            <MudText Typo="Typo.body1">@Result.Name</MudText>
            <MudText Typo="Typo.body2">...</MudText>
        </CardHeaderContent>
        <CardHeaderActions>
            @if (CanClose)
            {
                <MudIconButton Icon="@Icons.Material.Filled.Close" Color="Color.Default" />
            }
        </CardHeaderActions>
    </MudCardHeader>

    <MudCardContent>
        <MudGrid Spacing=0 Class="my-1">
            @if (Result.SuccessLevel != RollSuccessLevel.na)
            {
            <MudItem xs="4">
                <p>@l10n[Result.SuccessLevel.ToString()]</p>
            </MudItem>
            }
            <MudItem xs="8">
                <MudSimpleTable Dense=true Hover=false Bordered=false Striped=false Elevation=0 >
                @* Style="overflow-x: auto;" *@
                <tbody>
                    <tr>
                        @if (ShowValueLabels)
                        {
                        <td>@string.Join(" \u00B7 ", Result.GetPrimaryResult().RollResult)</td>
                        }
                        <td>@l10n["lblResultCardResult"]</td>
                        <td>@string.Join(" \u00B7 ", Result.GetPrimaryResult().RollResult)</td>
                    </tr>
                    @if (Result.SummarizedModifier != 0)
                    {
                    <tr>
                        <td>@l10n["lblResultCardModifier"]</td>
                        <td>@Result.SummarizedModifier</td>
                    </tr>
                    }
                </tbody>
            </MudSimpleTable>
            </MudItem>
        </MudGrid>
    </MudCardContent>
    <MudCardContent>
        <MudText Typo="Typo.body2">SOMETHING</MudText>
    </MudCardContent>
    @*<MudCardActions>
        <MudIconButton Icon="@Icons.Material.Filled.Favorite" Color="Color.Default" />
        <MudIconButton Icon="@Icons.Material.Filled.Share" Color="Color.Default" />
    </MudCardActions>*@
</MudCard>


@code {
    [Parameter]
    public RollCheckResultViMo Result { get; set; }

    [Parameter]
    public bool CanClose { get; set; } = false;

    [Parameter]
    public bool ShowValueLabels { get; set; } = false;


    private string GetAvatarIcon()
    {
        return Icons.Material.Filled.Accessibility;
    }

    //private RenderFragment MakeAvatar()
    //{
    //    switch (RollResult.CupType)
    //    {
    //        case FreeDiceCupViMo.CupType.Single: return @<span>@RollResult.DieSides[0]</span>;
    //        case FreeDiceCupViMo.CupType.Multi:  return @<span>@RollResult.DieSides[0]</span>;
    //        case FreeDiceCupViMo.CupType.MixedMulti: return @<span>MIX</span>;
    //        default: return @<span>MIX</span>; //@(<MudIcon Icon=Icons.Material.Filled.FormatListNumbered />);
    //    }
    //}
}
